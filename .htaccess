<IfModule mod_rewrite.c>
  RewriteEngine On
  RewriteBase /

  # Cache static assets for 1 year
  <FilesMatch "\.(ico|gif|png|jpg|jpeg|svg|webp)$">
    Header set Cache-Control "public, max-age=31536000, immutable"
  </FilesMatch>

  # Cache CSS/JS bundles with hash for 1 year
  <FilesMatch "\.[a-f0-9]{8}\.(js|css)$">
    Header set Cache-Control "public, max-age=31536000, immutable"
  </FilesMatch>

  # Don't cache HTML
  <FilesMatch "\.(html|htm)$">
    Header set Cache-Control "public, max-age=3600"
  </FilesMatch>

  # Route all requests to index.html for SPA, except API and existing files
  RewriteCond %{REQUEST_FILENAME} !-f
  RewriteCond %{REQUEST_FILENAME} !-d
  RewriteCond %{REQUEST_URI} !^/api/
  RewriteRule ^ index.html [QSA,L]
</IfModule>
